---
title: "spatialsample argument naming"
output: html_document
date: '2022-06-07'
---

`spatialsample` is a package implementing different spatial resampling methods:
different ways of spatially segmenting your data so that you can be more 
confident in your model's ability to extrapolate to new areas.

It comes with a data set that breaks the city of Boston into 682 hexagons:

```{r}
library(spatialsample)

plot(sf::st_geometry(boston_canopy))
```

There are currently two functions in `spatialsample` for resampling. The first,
`spatial_block_cv()`, lets you break your area into "blocks" which are treated
as different folds:

```{r}
set.seed(123)
spatial_block_cv(
  boston_canopy
) |> 
  autoplot(show_grid = FALSE)
```

Blocks can be assigned into folds either at random or systematically. If you 
want to use a non-default assignment method, you use the argument `method`:

```{r}
set.seed(123)
spatial_block_cv(
  boston_canopy,
  # `method` is implemented by spatialsample
  method = "continuous"
) |> 
  autoplot(show_grid = FALSE)
```

The other main function, `spatial_clustering_cv()`, uses a clustering algorithm
to group data into folds by proximity. The default approach is to use `kmeans()`
for clustering:

```{r}
set.seed(123)
spatial_clustering_cv(
  boston_canopy
) |> 
  autoplot()
```

But if you want to use a different clustering algorithm, you use the 
`cluster_function` argument. For instance, to use `hclust`:

```{r}
set.seed(123)
spatial_clustering_cv(
  boston_canopy,
  # `cluster_function` is implemented by spatialsample
  cluster_function = "hclust"
) |> 
  autoplot()
```

It feels to me that `clustering_function` and `method` are doing the same thing:
they're spatialsample-level arguments controlling how fold assignment is done.
The problem is that `spatial_clustering_cv` lets users pass `...` to whatever
clustering function they want, and `hclust` uses the `method` argument to 
control the algorithm:

```{r}
set.seed(123)
spatial_clustering_cv(
  boston_canopy,
  # `cluster_function` is implemented by spatialsample
  cluster_function = "hclust",
  # `method` is passed through ... to `hclust()`
  method = "average"
) |> 
  autoplot()
```

(For what it's worth, `kmeans()` uses `algorithm` for this purpose.)

We think that `clustering_function` and `method` are doing the same role, and so
should have the same name. We're not quite sure what's the best way to make that
happen. Here's some of our ideas, we'd love to hear what you think:

* Rename both arguments. Some ideas:
  * `<x>_by`:
    * cv_by (Julia's favorite)
    * assign_by
    * resample_by
  * synonyms:
    * mechanism
    * approach
    * process
  * `with_<x>`:
    * with_assignment
    * with_method
  * `<x>_method`:
    * assignment_method
    * resample_method
    * cv_method
  * Others???

* Force users to use `algorithm` for either the `kmeans()` or `hclust()` 
  methods, so if `...` contains a named argument `algorithm` we pass it to
  the `method` argument of `hclust()`. We'd then use `method` in all 
  `spatialsample` functions.
